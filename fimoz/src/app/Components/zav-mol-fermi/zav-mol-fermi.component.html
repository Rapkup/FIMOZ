<div class="container">
  <header>
    <img src="assets/images/logo.avif" alt="Колхоз" class="logo" />
    <button class="logout-button" (click)="logout()">Выйти из аккаунта</button>
  </header>

  <main>
    <h1>Заведующий молочной фермы</h1>
    <div class="content">
      <div class="sidebar">
        <button class="menu-item" [class.active]="activeSection === 'workers'" (click)="showSection('workers')">Список работников</button>
        <button class="menu-item" [class.active]="activeSection === 'tasks'" (click)="showSection('tasks')">Рабочие задачи</button>
        <button class="menu-item" [class.active]="activeSection === 'equipment'" (click)="showSection('equipment')">Мониторинг оборудования</button>
      </div>

      <div class="main-content">
        <!-- Список работников -->
        <div *ngIf="activeSection === 'workers'" class="section workers-section">
          <h2>Список работников</h2>
          <table>
            <thead>
              <tr>
                <th>Имя</th>
                <th>Категория</th>
                <th>Статус</th>
                <th>Действие</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let worker of availableWorkers">
                <td>{{ worker.name }}</td>
                <td>{{ worker.category }}</td>
                <td>{{ worker.status === 'available' ? 'Доступен' : 'Занят' }}</td>
                <td><button class="btn-select" (click)="selectWorker(worker)">Выбрать</button></td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Рабочие задачи -->
        <div *ngIf="activeSection === 'tasks'" class="section task-section">
          <h2>Рабочие задачи</h2>
          <table>
            <thead>
              <tr>
                <th>Работник</th>
                <th>Животное</th>
                <th>Доильная установка</th>
                <th>Статус</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let task of workerTasks">
                <td>{{ task.worker.name }}</td>
                <td>{{ task.animal.name }}</td>
                <td>{{ task.milkingMachine.name }}</td>
                <td>{{ task.status }}</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Мониторинг оборудования -->
        <div *ngIf="activeSection === 'equipment'" class="section equipment-section">
          <h2>Мониторинг оборудования</h2>
          <ul>
            <li *ngFor="let machine of milkingMachines">
              {{ machine.name }} - {{ machine.status === 'available' ? 'Работает' : 'Не работает' }}
              <button (click)="changeMilkingMachineStatus('available', machine)">Исправно</button>
              <button (click)="changeMilkingMachineStatus('not available', machine)">Неисправно</button>
            </li>
          </ul>
        </div>

        <!-- Назначение задачи -->
        <div *ngIf="taskModalOpen" class="section assign-task-section">
          <h3>Назначить задачу для {{ selectedWorker?.name }}</h3>
          <div>
            <label>Выберите животное:</label>
            <select [(ngModel)]="selectedAnimal">
              <option *ngFor="let animal of availableAnimals" [ngValue]="animal">{{ animal.name }}</option>
            </select>
          </div>
          <div>
            <label>Выберите доильную установку:</label>
            <select [(ngModel)]="selectedMilkingMachine">
              <option *ngFor="let machine of availableMilkingMachines" [ngValue]="machine">{{ machine.name }}</option>
            </select>
          </div>
          <button (click)="assignTask()">Назначить</button>
          <button (click)="taskModalOpen = false">Отмена</button>
        </div>

        <!-- Уведомления -->
        <div *ngIf="notification" class="notification">{{ notification }}</div>
        <div *ngIf="errorNotification" class="error-notification">{{ errorNotification }}</div>
      </div>
    </div>
  </main>
</div>
